<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="DOZ - vdom">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Doz - vdom</title>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=sunburst"></script>
    <script src="../dist/doz.js?589654"></script>
    <style>
        body {
            font-family: sans-serif;
        }

        div {
            font-size: 35px;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
<div id="app"></div>

<script>

    Doz.component('doz-clock',{
        props: {
            time: new Date().toLocaleTimeString(),
            record: []
        },

        addItem(e) {
            this.props.record.push({
                name: Math.random(),
                desc: new Date().toLocaleTimeString()
            });
        },

        removeItem(arg) {
            console.log(arg);
            this.props.record.splice([parseInt(arg[0])], 1);
            //delete this.props.record[parseInt(arg[0])];
        },

        template() {
            return (
`<div>
    <button onclick="this.addItem()" >Add item </button>
    <div>
        <strong>sono le ore ${this.props.time}</strong>
    </div>
    <ul>
    ${this.each(this.props.record, (item, i) => `<li>${item.name}<button onclick="this.removeItem(${i})">X</button></li>`)}
    </ul>
</div>`
            );
        },

        onCreate() {
            console.log('create');
        },
        onRender() {
            console.log('render');
            setInterval(() => {
                this.props.time = new Date().toLocaleTimeString();
                this.render();
            }, 1000)
        }
    });

    new Doz({
        root: document.getElementById('app'),
        template: `<doz-clock></doz-clock>`
    })

</script>
</body>
</html>