<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="DOZ - vdom">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Doz - vdom</title>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=sunburst"></script>
    <script src="../dist/doz.js?589654"></script>
    <style>
        body {
            font-family: sans-serif;
        }

        div {
            font-size: 35px;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
<div id="app"></div>

<script>

    const root = document.getElementById('app');


    const component = {
        _prevProps: null,
        _prev: null,
        props: {
            time: new Date().toLocaleTimeString(),
            record: []
        },

        each(obj, func) {
            return obj.map(func).join('');
        },

        myHandler(e) {
            e.target.parentNode.style.background = 'red';
        },

        template() {
            return (
                `
                    <div>
                        <button onclick="this.myHandler()" >Click me </button>
                        <div>
                            <strong>sono le ore</strong> ${this.props.time}
                        </div>
                        ${this.each(this.props.record, item => `<button >name: ${item.name}, desc: ${item.desc} .</button>`)}
                    </div>
                `
            );
        },

        render() {
            let next = Doz.transform(Doz.html.create(this.template()));

            Doz.update(root, next, this._prev, 0, this);

            this._prev = next;
            this._prevProps = Object.assign({}, this.props);
        },

        init() {
            this.render();
            setInterval(() => {
                this.props.time = new Date().toLocaleTimeString();
                this.render();
            }, 1000)
        }
    };

    component.init();
</script>
</body>
</html>